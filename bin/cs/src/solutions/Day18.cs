// Generated by Haxe 4.1.2

#pragma warning disable 109, 114, 219, 429, 168, 162
namespace solutions {
	public class Day18 : global::haxe.lang.HxObject {
		
		static Day18() {
			global::solutions.Day18.input = global::sys.io.File.getContent("E:/Mila/Documents/GitHub/adventofcode2020/src/inputs/Day18.txt");
		}
		
		
		public Day18(global::haxe.lang.EmptyObject empty) {
		}
		
		
		public Day18() {
			global::solutions.Day18.__hx_ctor_solutions_Day18(this);
		}
		
		
		protected static void __hx_ctor_solutions_Day18(global::solutions.Day18 __hx_this) {
		}
		
		
		public static string input;
		
		public static void solve() {
			global::System.Console.WriteLine(((object) ("Solving Day18") ));
			global::Array<string> arr = global::haxe.lang.StringExt.split(global::solutions.Day18.input, "\r\n");
			long sum = ((long) (0) );
			{
				int _g = 0;
				int _g1 = arr.length;
				while (( _g < _g1 )) {
					int i = _g++;
					global::System.Console.WriteLine(((object) (global::haxe.lang.Runtime.concat(global::haxe.lang.Runtime.concat(global::haxe.lang.Runtime.toString(i), ": "), arr[i])) ));
					if (( ((long) (global::solutions.Day18.evaluate(arr[i], "")) ) < ((long) (0) ) )) {
						break;
					}
					
					sum = ( ((long) (sum) ) + ((long) (global::solutions.Day18.evaluate(arr[i], "")) ) );
				}
				
			}
			
			global::System.Console.WriteLine(((object) (global::haxe.lang.Runtime.concat("a: ", (global::haxe.lang.Runtime.concat("", global::Std.@string(((long) (sum) )))))) ));
		}
		
		
		public static long evaluate(string expression, string opPreference) {
			unchecked {
				expression = global::StringTools.replace(expression, " ", "");
				global::System.Console.WriteLine(((object) (expression) ));
				int parens = 0;
				string subExpression = "";
				global::EReg ereg = new global::EReg("[(]", "");
				while (ereg.match(expression)) {
					int _g = 0;
					int _g1 = expression.Length;
					while (( _g < _g1 )) {
						int i = _g++;
						if (( global::haxe.lang.StringExt.charAt(expression, i) == "(" )) {
							 ++ parens;
						}
						
						if (( parens > 0 )) {
							subExpression = global::haxe.lang.Runtime.concat(subExpression, global::haxe.lang.StringExt.charAt(expression, i));
						}
						
						if (( global::haxe.lang.StringExt.charAt(expression, i) == ")" )) {
							 -- parens;
							if (( parens == 0 )) {
								global::System.Console.WriteLine(((object) (subExpression) ));
								expression = global::StringTools.replace(expression, subExpression, global::haxe.lang.Runtime.concat("", (global::haxe.lang.Runtime.concat("", global::Std.@string(((long) (global::solutions.Day18.evaluate(global::haxe.lang.StringExt.substr(subExpression, 1, new global::haxe.lang.Null<int>(( subExpression.Length - 2 ), true)), "")) ))))));
								global::System.Console.WriteLine(((object) (expression) ));
								subExpression = "";
								break;
							}
							
						}
						
					}
					
				}
				
				ereg = new global::EReg("[+*]", "");
				string currExpression = expression;
				long result = ((long) (0) );
				while (ereg.match(currExpression)) {
					long left = global::haxe._Int64.Int64_Impl_.parseString(ereg.matchedLeft());
					string op = ereg.matched(0);
					long right = default(long);
					global::EReg rightReg = new global::EReg("[+*]", "");
					if (rightReg.match(ereg.matchedRight())) {
						right = global::haxe._Int64.Int64_Impl_.parseString(rightReg.matchedLeft());
					}
					else {
						right = global::haxe._Int64.Int64_Impl_.parseString(ereg.matchedRight());
					}
					
					global::System.Console.WriteLine(((object) (left) ));
					global::System.Console.WriteLine(((object) (op) ));
					global::System.Console.WriteLine(((object) (right) ));
					result = ( (( op == "+" )) ? (((long) (( ((long) (left) ) + ((long) (right) ) )) )) : (((long) (( ((long) (left) ) * ((long) (right) ) )) )) );
					global::System.Console.WriteLine(((object) (global::haxe.lang.Runtime.concat("=", (global::haxe.lang.Runtime.concat("", global::Std.@string(((long) (result) )))))) ));
					global::System.Console.WriteLine(((object) ("") ));
					currExpression = global::haxe.lang.Runtime.concat(global::haxe.lang.Runtime.concat("", global::Std.@string(((long) (result) ))), global::haxe.lang.StringExt.substr(currExpression, (global::haxe.lang.Runtime.concat(global::haxe.lang.Runtime.concat(global::haxe.lang.Runtime.concat("", global::Std.@string(((long) (left) ))), op), (global::haxe.lang.Runtime.concat("", global::Std.@string(((long) (right) )))))).Length, default(global::haxe.lang.Null<int>)));
				}
				
				return result;
			}
		}
		
		
	}
}


